<html>

  <head>


    <style>
body {
  font-family: Arial;
}
/* Style the tab */
.charttab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}
/* Style the buttons inside the tab */
.charttab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}
/* Change background color of buttons on hover */
.charttab button:hover {
  background-color: #ddd;
}
/* Create an active/current tablink class */
.charttab button.active {
  background-color: #ccc;
}
/* Style the tab content */
.charttabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}
.button {
  background-color: #555555;
  border: none;
  color: white;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 12px;
  margin: 0px 0px;
  cursor: pointer;
}
/* Customize the label (the container) */
.container {
  display: block;
  position: relative;
  padding-left: 23px;
  padding-right: 20px;
  margin-bottom: 5px;
  cursor: pointer;
  font-size: 14px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  float: left;
}
/* Hide the browser's default checkbox */
.container input {
  position: absolute;
  opacity: 0;
  cursor: pointer;
}
/* Create a custom checkbox */
.checkmark {
  position: absolute;
  top: 0;
  left: 0;
  height: 20px;
  width: 20px;
  background-color: #bebebe;
}
/* On mouse-over, add a grey background color */
.container:hover input~.checkmark {
  background-color: #ccc;
}
/* When the checkbox is checked, add a blue background */
.container input:checked~.checkmark {
  background-color: #2196F3;
}
/* Create the checkmark/indicator (hidden when not checked) */
.checkmark:after {
  content: "";
  position: absolute;
  display: none;
}
/* Show the checkmark when checked */
.container input:checked~.checkmark:after {
  display: block;
}
/* Style the checkmark/indicator */
.container .checkmark:after {
  left: 5px;
  top: 3px;
  width: 5px;
  height: 8px;
  border: solid white;
  border-width: 0 3px 3px 0;
  -webkit-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  transform: rotate(45deg);
}
    </style>
  </head>

  <body>
    <title> Data Visualisations </title>


    <div class="charttab">
      <button id="chartab1" class="charttablinks">Market Map</button>
      <button id="chartab2" class="charttablinks">Asset Class Chart</button>
    </div>


    <div id="Map" class="charttabcontent">

      <div id="programmatic_dashboard_div_Map" style="border: 1px solid #ccc; height:100%">
        <table class="columns" style="height: 50px">
          <tr>
            <td>
              <p> Select:
                <input type="button" value="MTD" id="b1Map" class="button" style="margin: 0px 0px;" />
                <input type="button" value="YTD" id="b2Map" class="button" style="margin: 0px 0px;" />
                <input type="button" value="2017" id="b3Map" class="button" style="margin: 0px 0px;" />
              </p>
            </td>
            <td>

              <div id="programmatic_control_Map"></div>


            </td>
          </tr>
        </table>
        <div style="width: 100%; overflow:hidden;" id="Outer">
          <div style="margin-top:-20%;" id="programmatic_chart_divMap"></div>
        </div>
      </div>
    </div>

    <div id="AssetClassChart" class="charttabcontent">
      <div id="programmatic_dashboard_divBar" style="border: 1px solid #ccc">
        <table class="columns" style="height: 50px">
          <tr>
            <td>
              <p> Select:
                <input type="button" value="MTD" id="b1" class="button" style="margin: 0px 0px;" />
                <input type="button" value="YTD" id="b2" class="button" style="margin: 0px 0px;" />
                <input type="button" value="2017" id="b3" class="button" style="margin: 0px 0px;" />
              </p>
            </td>
            <td>

              <div style="position:absolute; right:5px; top: 70px;">

                <label class="container">USD
  <input type="checkbox" id="USDCheck" onchange="testfunction()">
  <span class="checkmark"></span>
              </label>

                <label class="container">GBP
  <input type="checkbox" id="GBPCheck">
  <span class="checkmark"></span>
</label>

                <label class="container">EUR
  <input type="checkbox" id="EURCheck">
  <span class="checkmark"></span>
</label>

<label class="container">CHF
  <input type="checkbox" id="CHFCheck">
  <span class="checkmark"></span>
</label>

                <label class="container">LC
                <input type="checkbox" id="LCCheck">
                  <span class="checkmark"></span>
</label>

                <div id="programmatic_control_divBar"></div>

              </div>
            </td>
          </tr>
        </table>
        <div id="programmatic_chart_divBar" style="width: 100%; height: 500px; "></div>
      </div>

    </div>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
    <script type="text/javascript">
// Load the Visualization API and the corechart package.
google.charts.load('current', {
  'packages': ['corechart', 'geochart', 'controls'],
  'mapsApiKey': 'AIzaSyAkxpo-VSfUXL2i5nP5MC0Y2RYaEz5iDsI'
});
// Set a callback to run when the Google Visualization API is loaded.
google.charts.setOnLoadCallback(Init2);
function Init2() {
  $.get("AllCountries6.csv", function(csvString1) {
    $.get("MarketReturns.csv", function(csvString2) {
      // transform the CSV string into a 2-dimensional array
      var DataABar = $.csv.toArrays(csvString2, {
        onParseValue: $.csv.hooks.castToScalar
      });
      var DataA = $.csv.toArrays(csvString1, {
        onParseValue: $.csv.hooks.castToScalar
      });
      // Create the data table.
      var dashboardBar = new google.visualization.Dashboard(
        document.getElementById('programmatic_dashboard_divBar'));
      var programmaticFilterBar = new google.visualization.ControlWrapper({
        'controlType': 'CategoryFilter',
        'containerId': 'programmatic_control_divBar',
        'options': {
          'filterColumnIndex': 0,
          'ui': {
            'labelStacking': 'vertical',
            'label': '',
            'allowTyping': false,
            'allowMultiple': true
          }
        }
      });
      //state: initState
      var dataBarInitial = google.visualization.arrayToDataTable(DataABar); //YTD = 0
      var chartBar = new google.visualization.ChartWrapper({
        'chartType': 'ColumnChart',
        'containerId': 'programmatic_chart_divBar',
        'options': {
          'pieSliceText': 'label',
          vAxis: {
            format: '#,###%'
          },
          animation: {
            duration: 1000,
            easing: 'out',
            startup: false
          },
        }
      });
      chartBar.setView({
        'columns': [0, 1], // GBP initial
      })
      // this filters the data to YTD. Leaves all other columns in place
    var view = new google.visualization.DataView(dataBarInitial);
    var rowIndexes = view.getFilteredRows([{column: 2, value: null}]); //get rows with 0 values
    view.hideRows(rowIndexes); //hide empty rows
    dataBar= view.toDataTable();
      var filterdataBar = new google.visualization.DataView(dataBar)
      var aBar = dataBar.getFilteredRows([{
        column: 1,
        value: 'MTD' // filter for both chart type and time horizon from single CSV
        //column: 1, value: ('MTD','All Cap')
      }])
      filterdataBar.setRows(aBar)
      filterdataBar.setColumns([0,2,3,4,5,6]) 
     
      dashboardBar.bind(programmaticFilterBar, chartBar);
      var dashboard = new google.visualization.Dashboard(
        document.getElementById('programmatic_dashboard_div_Map'));
      var initState = {
        selectedValues: []
      };
      initState.selectedValues.push('Equity');
      var programmaticFilter = new google.visualization.ControlWrapper({
        'controlType': 'CategoryFilter',
        'containerId': 'programmatic_control_Map',
        'options': {
          'filterColumnLabel': 'Asset Class',
          'ui': {
            'labelStacking': 'vertical',
            'label': '',
            'allowTyping': false,
            'caption': 'Choose Asset Class...',
            'cssClass': 'filter',
            'allowMultiple': false
          }
        },
        state: initState // sets the initial map to equities
      });
      var data = google.visualization.arrayToDataTable(DataA); //YTD = 0
      var chart = new google.visualization.ChartWrapper({
        'chartType': 'GeoChart',
        'containerId': 'programmatic_chart_divMap',
        'options': {
          'colorAxis': {
            colors: ['#e31b23', 'white', '#00853f']
          },
          animation: {
            duration: 1000,
            easing: 'out',
            startup: false
          },
        }
      });
      chart.setView({
        'columns': [0, 1], // chart view is only the country names and returns
      })
      // this filters the data to YTD. Leaves all other columns in place
      var filterdata = new google.visualization.DataView(data)
      var a = data.getFilteredRows([{
        column: 1,
        value: 'MTD'
      }])
      filterdata.setRows(a)
      filterdata.setColumns([0, 2, 3]) // data set is country label, returns, and asset class
      dashboard.bind(programmaticFilter, chart);
      var charttab1var = document.getElementById("chartab1");
      var charttab2var = document.getElementById("chartab2");
      charttab1var.onclick = function() {
        var charttabcontentvar = document.getElementById("AssetClassChart"); //hides bar content
        charttabcontentvar.style.display = "none";
        var tablinks = document.getElementsByClassName('charttablinks'); //unactivates map link
        tablinks[0].className = tablinks[0].className.replace(" active", "");
        tablinks[1].className = tablinks[1].className.replace(" active", "");
        document.getElementById("Map").style.display = "block"; //unhides bar content
        document.getElementById("chartab1").className += " active"; // makes button two look activated
        charttab2var.disabled = true;
        charttab1var.disabled = true;
        dashboard.draw(filterdata);
        charttab2var.disabled = false;
        charttab1var.disabled = false;
      }
      charttab2var.onclick = function() {
        var charttabcontentvar = document.getElementById("Map"); //hides map content
        charttabcontentvar.style.display = "none";
        var tablinks = document.getElementsByClassName('charttablinks'); //unactivates map link
        tablinks[0].className = tablinks[0].className.replace(" active", "");
        tablinks[1].className = tablinks[1].className.replace(" active", "");
        document.getElementById("AssetClassChart").style.display = "block"; //unhides bar content
        document.getElementById("chartab2").className += " active"; // makes button two look activated
        charttab2var.disabled = true;
        chartab1var.disabled = true;
        dashboardBar.draw(filterdataBar);
        charttab2var.disabled = false;
        charttab1var.disabled = false;
      }
      document.getElementsByClassName('charttablinks')[0].click() //activates tab 1
      //Area covers button interactions
      var button1 = document.getElementById("b1");
      var button2 = document.getElementById("b2");
      var button3 = document.getElementById("b3");
      var buttoncolour = "#555555"
      //function runs on button click
      function drawBarChart() {
        // Disabling the button while the chart is drawing.
        button1.disabled = true;
        button2.disabled = true;
        button3.disabled = true;
        google.visualization.events.addListener(dashboardBar, 'ready',
          function() {
            button1.disabled = false;
            button2.disabled = false;
            button3.disabled = false;
          });
        dashboardBar.draw(filterdataBar);
      }
      //runs if the MTD button is clicked
      button1.onclick = function() {
        button1.style.background = buttoncolour
        button1.style.color = "white";
        button2.style.background = "#F5A623"
        button3.style.background = "#F5A623"
        filterdataBar.setRows(dataBar.getFilteredRows([{
          column: 1,
          value: 'MTD' // MTD is the starting filter
        }]))
        drawBarChart();
        button1.disabled = true;
      };
      //runs if the YTD button is clicked
      button2.onclick = function() {
        button2.style.background = buttoncolour
        button2.style.color = "white";
        button1.style.background = "#F5A623"
        button3.style.background = "#F5A623"
        filterdataBar.setRows(dataBar.getFilteredRows([{
          column: 1,
          value: 'YTD' // yTD is the starting filter
        }]))
        drawBarChart();
        button2.disabled = true;
      };
      // runs if 2017 is clicked
      button3.onclick = function() {
        button3.style.background = buttoncolour
        button3.style.color = "white";
        button1.style.background = "#F5A623"
        button2.style.background = "#F5A623"
        filterdataBar.setRows(dataBar.getFilteredRows([{
          column: 1,
          value: 'Year2017' // 2017 is the starting filter
        }]))
        drawBarChart();
        button3.disabled = true;
      };
      // sets default button colours
      button1.style.background = buttoncolour
      button1.style.color = "white";
      button2.style.background = "#F5A623"
      button3.style.background = "#F5A623"
      // creates tick box variables
      var GBPCheckBox = document.getElementById("GBPCheck");
      var USDCheckBox = document.getElementById("USDCheck");
      var EURCheckBox = document.getElementById("EURCheck");
var CHFCheckBox = document.getElementById("CHFCheck");
      var LCCheckBox = document.getElementById("LCCheck");
      GBPCheckBox.checked = true //by default GBP is returns
      //the function which is run if a tick box 
      //references should refer to the view which has time (second column in Data) removed
      function CheckWhatsTicked() {
        var ColArray = [0]
      
        if (USDCheckBox.checked) {
          ColArray.push(2) //adds US colum reference to the collum re array if ticked
        }
        if (GBPCheckBox.checked) {
          ColArray.push(1) //adds GBP colum reference to the collum re array if ticked
        }
        if (EURCheckBox.checked) {
          ColArray.push(3) //adds EU colum reference to the collum re array if ticked
        }
        if (CHFCheckBox.checked) {
          ColArray.push(4) //adds CHF colum reference to the collum re array if ticked
        }
        if (LCCheckBox.checked) {
          ColArray.push(5) //adds LC colum reference to the collum re array if ticked
        }
        if (ColArray.length == 1) {
          ColArray.push(1)
        }
        chartBar.setView({
          'columns': ColArray,
        })
        drawBarChart();
      }
      // runs functions if USD tick box is changed
      USDCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      // runs functions if GBP tick box is changed
      GBPCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      // runs functions if EUR tick box is changed
      EURCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      // runs functions if CHF tick box is changed
      CHFCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      // runs functions if LC tick box is changed
      LCCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      //Area covers button interactions
      var Mapbutton1 = document.getElementById("b1Map");
      var Mapbutton2 = document.getElementById("b2Map");
      var Mapbutton3 = document.getElementById("b3Map");
      //function runs on button click
      function drawMapChart() {
        // Disabling the button while the chart is drawing.
        Mapbutton1.disabled = true;
        Mapbutton2.disabled = true;
        Mapbutton3.disabled = true;
        google.visualization.events.addListener(chart, 'ready',
          function() {
            Mapbutton1.disabled = false;
            Mapbutton2.disabled = false;
            Mapbutton3.disabled = false;
          });
        dashboard.draw(filterdata);
      }
      //runs if the MTD button is clicked
      Mapbutton1.onclick = function() {
        Mapbutton1.style.background = buttoncolour
        Mapbutton1.style.color = "white";
        Mapbutton2.style.background = "#F5A623"
        Mapbutton3.style.background = "#F5A623"
        filterdata.setRows(data.getFilteredRows([{
          column: 1,
          value: 'MTD' // MTD is the starting filter
        }]))
        drawMapChart();
        Mapbutton1.disabled = true;
      };
      //runs if the YTD button is clicked
      Mapbutton2.onclick = function() {
        Mapbutton2.style.background = buttoncolour
        Mapbutton2.style.color = "white";
        Mapbutton1.style.background = "#F5A623"
        Mapbutton3.style.background = "#F5A623"
        filterdata.setRows(data.getFilteredRows([{
          column: 1,
          value: 'YTD' // yTD is the starting filter
        }]))
        drawMapChart();
        Mapbutton2.disabled = true;
      };
      // runs if 2017 is clicked
      Mapbutton3.onclick = function() {
        Mapbutton3.style.background = buttoncolour
        Mapbutton3.style.color = "white";
        Mapbutton1.style.background = "#F5A623"
        Mapbutton2.style.background = "#F5A623"
        filterdata.setRows(data.getFilteredRows([{
          column: 1,
          value: 'Year2017' // 2017 is the starting filter
        }]))
        drawMapChart();
        Mapbutton3.disabled = true;
      };
      // sets default button colours
      Mapbutton1.style.background = buttoncolour
      Mapbutton1.style.color = "white";
      Mapbutton2.style.background = "#F5A623"
      Mapbutton3.style.background = "#F5A623"
      $(window).resize(function() {
        dashboardBar.draw(filterdataBar)
        dashboard.draw(filterdata)
      });
<<<<<<< HEAD

$('a[data-toggle="charttab"]').on('shown.bs.tab', function (e) {
  window.dispatchEvent(new Event('resize'));
});

=======
>>>>>>> 19fdf730b0702fa1fedbde8ca99859bd397b0e35
    })
  })
}
    </script>

  </body>

</html>
