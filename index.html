<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {font-family: Arial;}
/* Style the tab */
.tab {
    overflow: hidden;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
}
/* Style the buttons inside the tab */
.tab input {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
    font-size: 17px;
}
/* Change background color of buttons on hover */
.tab input:hover {
    background-color: #ddd;
}
/* Create an active/current tablink class */
.tab button.active {
    background-color: #ccc;
}
/* Style the tab content */
.tabcontent {
    display: none;
    padding: 6px 12px;
    border: 1px solid #ccc;
    border-top: none;
}
</style>
</head>
<body>

<p>Click on the buttons inside the tabbed menu:</p>

<div class="tab">
  <input type="button" class="tablinks" onclick="openCity(event, 'London')" value="London"/>
  <input type="button" id="Parisbutton" class="tablinks" onclick="openCity(event, 'Paris')" value ="Paris"/>
  <input type="button" class="tablinks" onclick="openCity(event, 'Tokyo')" value="Tokyo" />
</div>

<div id="London" class="tabcontent">
  <h3>London</h3>
  <p>London is the capital city of England.</p>


<div id="programmatic_dashboard_div_Map" style="border: 1px solid #ccc; height:100%">
        <table class="columns" style="height: 50px">
          <tr>
            <td>
              <p> Select:
                <input type="button" value="MTD" id="b1Map" class="button" style="margin: 0px 0px;" />
                <input type="button" value="YTD" id="b2Map" class="button" style="margin: 0px 0px;" />
                <input type="button" value="2017" id="b3Map" class="button" style="margin: 0px 0px;" />
              </p>
            </td>
            <td>

              <div id="programmatic_control_Map"></div>


            </td>
          </tr>
        </table>
        <div style="width: 100%; overflow:hidden; height: 500px;" id="Outer">
          <div style="margin-top:-20%;" id="programmatic_chart_divMap"></div>
        </div>
      </div>





</div>

<div id="Paris" class="tabcontent">
  <h3>Paris</h3>
  <p>Paris is the capital of France.</p> 
	    <div id="AssetClassChart" class="charttabcontent">
    <p>
tst bar
</p>
      <div id="programmatic_dashboard_divBar" style="border: 1px solid #ccc">
        <table class="columns" style="height: 50px">
          <tr>
            <td>
              <p> Select:
                <input type="button" value="MTD" id="b1" class="button" style="margin: 0px 0px;" />
                <input type="button" value="YTD" id="b2" class="button" style="margin: 0px 0px;" />
                <input type="button" value="2017" id="b3" class="button" style="margin: 0px 0px;" />
              </p>
            </td>
            <td>

              <div style="position:absolute; right:5px; top: 70px;">

                <label class="container">USD
  <input type="checkbox" id="USDCheck" onchange="testfunction()">
  <span class="checkmark"></span>
              </label>

                <label class="container">GBP
  <input type="checkbox" id="GBPCheck">
  <span class="checkmark"></span>
</label>

                <label class="container">EUR
  <input type="checkbox" id="EURCheck">
  <span class="checkmark"></span>
</label>

<label class="container">CHF
  <input type="checkbox" id="CHFCheck">
  <span class="checkmark"></span>
</label>

                <label class="container">LC
                <input type="checkbox" id="LCCheck">
                  <span class="checkmark"></span>
</label>

                <div id="programmatic_control_divBar"></div>

              </div>
            </td>
          </tr>
        </table>
        <div id="programmatic_chart_divBar" style="width: 100%; height: 500px; "></div>
      </div>

    </div>



</div>

<div id="Tokyo" class="tabcontent">
  <h3>Tokyo</h3>
  <p>Tokyo is the capital of Japan.</p>
</div>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
    <script type="text/javascript">
// Load the Visualization API and the corechart package.
google.charts.load('current', {
  'packages': ['corechart', 'geochart', 'controls'],
  'mapsApiKey': 'AIzaSyAkxpo-VSfUXL2i5nP5MC0Y2RYaEz5iDsI'
});
// Set a callback to run when the Google Visualization API is loaded.
google.charts.setOnLoadCallback(Init2);
function Init2() {
  $.get("AllCountries6.csv", function(csvString1) {
    $.get("MarketReturns.csv", function(csvString2) {
      // transform the CSV string into a 2-dimensional array
      var DataABar = $.csv.toArrays(csvString2, {
        onParseValue: $.csv.hooks.castToScalar
      });
      var DataA = $.csv.toArrays(csvString1, {
        onParseValue: $.csv.hooks.castToScalar
      });
      // Create the data table.
      var dashboardBar = new google.visualization.Dashboard(
        document.getElementById('programmatic_dashboard_divBar'));
      var programmaticFilterBar = new google.visualization.ControlWrapper({
        'controlType': 'CategoryFilter',
        'containerId': 'programmatic_control_divBar',
        'options': {
          'filterColumnIndex': 0,
          'ui': {
            'labelStacking': 'vertical',
            'label': '',
            'allowTyping': false,
            'allowMultiple': true
          }
        }
      });
      //state: initState
      var dataBarInitial = google.visualization.arrayToDataTable(DataABar); //YTD = 0
      var chartBar = new google.visualization.ChartWrapper({
        'chartType': 'ColumnChart',
        'containerId': 'programmatic_chart_divBar',
        'options': {
          'pieSliceText': 'label',
          vAxis: {
            format: '#,###%'
          },
          animation: {
            duration: 1000,
            easing: 'out',
            startup: false
          },
        }
      });
      chartBar.setView({
        'columns': [0, 1], // GBP initial
      })
      // this filters the data to YTD. Leaves all other columns in place
    var view = new google.visualization.DataView(dataBarInitial);
    var rowIndexes = view.getFilteredRows([{column: 2, value: null}]); //get rows with 0 values
    view.hideRows(rowIndexes); //hide empty rows
    dataBar= view.toDataTable();
      var filterdataBar = new google.visualization.DataView(dataBar)
      var aBar = dataBar.getFilteredRows([{
        column: 1,
        value: 'MTD' // filter for both chart type and time horizon from single CSV
        //column: 1, value: ('MTD','All Cap')
      }])
      filterdataBar.setRows(aBar)
      filterdataBar.setColumns([0,2,3,4,5,6]) 
     
      dashboardBar.bind(programmaticFilterBar, chartBar);
      var dashboard = new google.visualization.Dashboard(
        document.getElementById('programmatic_dashboard_div_Map'));
      var initState = {
        selectedValues: []
      };
      initState.selectedValues.push('Equity');
      var programmaticFilter = new google.visualization.ControlWrapper({
        'controlType': 'CategoryFilter',
        'containerId': 'programmatic_control_Map',
        'options': {
          'filterColumnLabel': 'Asset Class',
          'ui': {
            'labelStacking': 'vertical',
            'label': '',
            'allowTyping': false,
            'caption': 'Choose Asset Class...',
            'cssClass': 'filter',
            'allowMultiple': false
          }
        },
        state: initState // sets the initial map to equities
      });
      var data = google.visualization.arrayToDataTable(DataA); //YTD = 0
      var chart = new google.visualization.ChartWrapper({
        'chartType': 'GeoChart',
        'containerId': 'programmatic_chart_divMap',
        'options': {
          'colorAxis': {
            colors: ['#e31b23', 'white', '#00853f']
          },
          animation: {
            duration: 1000,
            easing: 'out',
            startup: false
          },
        }
      });
      chart.setView({
        'columns': [0, 1], // chart view is only the country names and returns
      })
      // this filters the data to YTD. Leaves all other columns in place
      var filterdata = new google.visualization.DataView(data)
      var a = data.getFilteredRows([{
        column: 1,
        value: 'MTD'
      }])
      filterdata.setRows(a)
      filterdata.setColumns([0, 2, 3]) // data set is country label, returns, and asset class
      dashboard.bind(programmaticFilter, chart);
      //document.getElementsByClassName('charttablinks')[0].click() //activates tab 1
      //Area covers button interactions
dashboardBar.draw(filterdataBar);
dashboard.draw(filterdata);
	    
      var button1 = document.getElementById("b1");
      var button2 = document.getElementById("b2");
      var button3 = document.getElementById("b3");
      var buttoncolour = "#555555"
      //function runs on button click
      function drawBarChart() {
        // Disabling the button while the chart is drawing.
        button1.disabled = true;
        button2.disabled = true;
        button3.disabled = true;
        google.visualization.events.addListener(dashboardBar, 'ready',
          function() {
            button1.disabled = false;
            button2.disabled = false;
            button3.disabled = false;
          });
        dashboardBar.draw(filterdataBar);
      }
      //runs if the MTD button is clicked
      button1.onclick = function() {
        button1.style.background = buttoncolour
        button1.style.color = "white";
        button2.style.background = "#F5A623"
        button3.style.background = "#F5A623"
        filterdataBar.setRows(dataBar.getFilteredRows([{
          column: 1,
          value: 'MTD' // MTD is the starting filter
        }]))
        drawBarChart();
        button1.disabled = true;
      };
      //runs if the YTD button is clicked
      button2.onclick = function() {
        button2.style.background = buttoncolour
        button2.style.color = "white";
        button1.style.background = "#F5A623"
        button3.style.background = "#F5A623"
        filterdataBar.setRows(dataBar.getFilteredRows([{
          column: 1,
          value: 'YTD' // yTD is the starting filter
        }]))
        drawBarChart();
        button2.disabled = true;
      };
      // runs if 2017 is clicked
      button3.onclick = function() {
        button3.style.background = buttoncolour
        button3.style.color = "white";
        button1.style.background = "#F5A623"
        button2.style.background = "#F5A623"
        filterdataBar.setRows(dataBar.getFilteredRows([{
          column: 1,
          value: 'Year2017' // 2017 is the starting filter
        }]))
        drawBarChart();
        button3.disabled = true;
      };
      // sets default button colours
      button1.style.background = buttoncolour
      button1.style.color = "white";
      button2.style.background = "#F5A623"
      button3.style.background = "#F5A623"
      // creates tick box variables
      var GBPCheckBox = document.getElementById("GBPCheck");
      var USDCheckBox = document.getElementById("USDCheck");
      var EURCheckBox = document.getElementById("EURCheck");
var CHFCheckBox = document.getElementById("CHFCheck");
      var LCCheckBox = document.getElementById("LCCheck");
      GBPCheckBox.checked = true //by default GBP is returns
      //the function which is run if a tick box 
      //references should refer to the view which has time (second column in Data) removed
      function CheckWhatsTicked() {
        var ColArray = [0]
      
        if (USDCheckBox.checked) {
          ColArray.push(2) //adds US colum reference to the collum re array if ticked
        }
        if (GBPCheckBox.checked) {
          ColArray.push(1) //adds GBP colum reference to the collum re array if ticked
        }
        if (EURCheckBox.checked) {
          ColArray.push(3) //adds EU colum reference to the collum re array if ticked
        }
        if (CHFCheckBox.checked) {
          ColArray.push(4) //adds CHF colum reference to the collum re array if ticked
        }
        if (LCCheckBox.checked) {
          ColArray.push(5) //adds LC colum reference to the collum re array if ticked
        }
        if (ColArray.length == 1) {
          ColArray.push(1)
        }
        chartBar.setView({
          'columns': ColArray,
        })
        drawBarChart();
      }
      // runs functions if USD tick box is changed
      USDCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      // runs functions if GBP tick box is changed
      GBPCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      // runs functions if EUR tick box is changed
      EURCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      // runs functions if CHF tick box is changed
      CHFCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      // runs functions if LC tick box is changed
      LCCheckBox.onchange = function() {
        CheckWhatsTicked()
      };
      //Area covers button interactions
      var Mapbutton1 = document.getElementById("b1Map");
      var Mapbutton2 = document.getElementById("b2Map");
      var Mapbutton3 = document.getElementById("b3Map");
      //function runs on button click
      function drawMapChart() {
        // Disabling the button while the chart is drawing.
        Mapbutton1.disabled = true;
        Mapbutton2.disabled = true;
        Mapbutton3.disabled = true;
        google.visualization.events.addListener(chart, 'ready',
          function() {
            Mapbutton1.disabled = false;
            Mapbutton2.disabled = false;
            Mapbutton3.disabled = false;
          });
        dashboard.draw(filterdata);
      }
      //runs if the MTD button is clicked
      Mapbutton1.onclick = function() {
        Mapbutton1.style.background = buttoncolour
        Mapbutton1.style.color = "white";
        Mapbutton2.style.background = "#F5A623"
        Mapbutton3.style.background = "#F5A623"
        filterdata.setRows(data.getFilteredRows([{
          column: 1,
          value: 'MTD' // MTD is the starting filter
        }]))
        drawMapChart();
        Mapbutton1.disabled = true;
      };
      //runs if the YTD button is clicked
      Mapbutton2.onclick = function() {
        Mapbutton2.style.background = buttoncolour
        Mapbutton2.style.color = "white";
        Mapbutton1.style.background = "#F5A623"
        Mapbutton3.style.background = "#F5A623"
        filterdata.setRows(data.getFilteredRows([{
          column: 1,
          value: 'YTD' // yTD is the starting filter
        }]))
        drawMapChart();
        Mapbutton2.disabled = true;
      };
      // runs if 2017 is clicked
      Mapbutton3.onclick = function() {
        Mapbutton3.style.background = buttoncolour
        Mapbutton3.style.color = "white";
        Mapbutton1.style.background = "#F5A623"
        Mapbutton2.style.background = "#F5A623"
        filterdata.setRows(data.getFilteredRows([{
          column: 1,
          value: 'Year2017' // 2017 is the starting filter
        }]))
        drawMapChart();
        Mapbutton3.disabled = true;
      };
      // sets default button colours
      Mapbutton1.style.background = buttoncolour
      Mapbutton1.style.color = "white";
      Mapbutton2.style.background = "#F5A623"
      Mapbutton3.style.background = "#F5A623"
      $(window).resize(function() {
        dashboardBar.draw(filterdataBar)
        dashboard.draw(filterdata)
      });
	    
    })
  })
}
function openCity(evt, cityName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
    Init2();
	//drawBarChart()
}
</script>
     
</body>
</html> 
